<div class="w-full space-y-6">
  <!-- User Info Card -->
  @if (currentUser()) {
    <p-card>
      <ng-template #header>
        <div class="p-6 pb-0">
          <div class="flex items-center justify-between">
            <div>
              <h2 class="text-2xl font-semibold">{{ currentUser()!.name }}</h2>
              <p>{{ currentUser()!.email }}</p>
            </div>
            <p-button
              icon="pi pi-arrow-left"
              [text]="true"
              label="Back to Users"
              (onClick)="goBack()"
            />
          </div>
        </div>
      </ng-template>
    </p-card>
  }

  <!-- Addresses Card -->
  <p-card>
    <ng-template #header>
      <div class="p-6 pb-0">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-xl font-semibold">Addresses</h3>
          <p-button
            icon="pi pi-plus"
            label="Add Address"
            (onClick)="showAddAddressDialog.set(true)"
          />
        </div>
      </div>
    </ng-template>

    @if (adminState.isLoadingAddresses()) {
      <div class="space-y-2">
        <p-skeleton height="100px" />
        <p-skeleton height="100px" />
        <p-skeleton height="100px" />
      </div>
    } @else if (adminState.userAddresses().length === 0) {
      <div class="text-center py-12">
        <i class="pi pi-map-marker text-6xl mb-4"></i>
        <p class="text-lg mb-4">No addresses found</p>
        <p-button
          icon="pi pi-plus"
          label="Add First Address"
          (onClick)="showAddAddressDialog.set(true)"
        />
      </div>
    } @else {
      <div class="grid grid-cols-1 gap-4">
        @for (addr of adminState.userAddresses(); track addr.id) {
          <div
            class="border border-surface-200 dark:border-surface-700 rounded-lg p-4 cursor-pointer hover:bg-surface-50 dark:hover:bg-surface-800 transition-colors"
            (click)="onAddressClick(addr)"
          >
            <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3">
              <div class="flex-1">
                <div class="flex items-start gap-2 mb-2">
                  <i class="pi pi-map-marker mt-1"></i>
                  <div>
                    <p class="font-semibold">{{ addr.address }}</p>
                    @if (addr.addressNotes) {
                      <p class="text-sm mt-1">{{ addr.addressNotes }}</p>
                    }
                  </div>
                </div>

                <div class="flex flex-wrap gap-3 mt-3 text-sm">
                  <div class="flex items-center gap-1">
                    <i class="pi pi-trash text-xs"></i>
                    <span>{{ addr.totalBins }} bin{{ addr.totalBins !== 1 ? 's' : '' }}</span>
                  </div>
                </div>
              </div>

              <div class="flex items-center gap-2">
                <p-tag
                  [value]="getStatusLabel(addr.addressStatus)"
                  [severity]="getStatusSeverity(addr.addressStatus)"
                />
                <i class="pi pi-chevron-right"></i>
              </div>
            </div>
          </div>
        }
      </div>
    }
  </p-card>

  <!-- Add Address Dialog -->
  <app-add-address-dialog
    [visible]="showAddAddressDialog()"
    (saved)="onSaveAddress($event)"
    (cancelled)="showAddAddressDialog.set(false)"
  />
</div>
